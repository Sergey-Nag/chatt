{"version":3,"sources":["components/ChatLayout/ChatMessages/MessageBox/MessageBox.module.css","components/Lists/ListCard/ListCard.module.css","components/FormatTextEditor/FormatTextEditor.module.css","components/ChatLayout/ChatLayout.module.css","models/Message.js","helpers/Database.js","context/auth/authActions.js","context/auth/authContext.js","context/auth/authReducer.js","helpers/returnArrayFromObj.js","hooks/useListenFirebaseData.js","helpers/authData.js","routes/Auth/AuthRoute.jsx","components/Header/Header.jsx","helpers/dateTime.js","components/Lists/ListCard/ListCard.jsx","components/Lists/UsersList/UsersList.jsx","components/Lists/ChatsList/ChatCard/ChatCard.jsx","components/Lists/ChatsList/ChatsList.jsx","components/Lists/Lists.jsx","routes/Chat/ChatRoute.jsx","routes/ProtectedRoute/ProtectedRoute.jsx","components/CreateChat/CreateChat.jsx","components/FormatTextEditor/FormatTextEditor.jsx","components/ChatLayout/ChatInput/ChatInput.jsx","components/ChatLayout/ChatMessages/MessageBox/MessageBox.jsx","components/ChatLayout/ChatMessages/ChatMessages.jsx","components/ChatLayout/ChatLayout.jsx","components/BlankChat/BlankChat.jsx","App.jsx","reportWebVitals.js","firebaseApp.js","index.jsx"],"names":["module","exports","Message","from","text","textMarkup","timestamp","trim","this","Date","now","Database","fireApp","_app","getDatabase","path","ref","_getDb","a","dbRef","_getDbRef","get","child","snapshot","val","console","log","data","db","set","e","callback","limit","dbQuery","query","orderByKey","limitToLast","onValue","snap","off","runTransaction","userNickname","companioNickname","chatId","toString","newMessage","writeData","chatBetween","createdAt","lastMessage","pushMessageToChat","updateData","_addFieldToArr","newMessageData","chatRef","newMsgRef","push","then","field","Array","isArray","includes","DB","authUser","userObj","nickname","dataObj","localStorage","setItem","JSON","stringify","type","payload","defaultAuth","authState","getItem","user","parse","AuthContext","createContext","authReducer","state","returnArrayFromObj","obj","withKeys","Object","keys","map","key","values","useListenFirebaseData","queryPath","filterCallback","startListen","saveKey","useState","setData","useEffect","unsubscribe","listenData","filter","getUserObject","providerData","metadata","email","split","replace","lastLoginAt","AuthRoute","useContext","auth","dispatch","authorize","useCallback","getAuth","provider","GoogleAuthProvider","signInWithPopup","authResult","document","title","to","className","style","height","onClick","Header","isAside","setAside","companion","useMemo","photoURL","displayName","src","profile_picture","alt","width","username","id","href","removeItem","getLastDateTime","date","moment","today","isAfter","format","getFullMessageTime","ListCard","photo","time","link","Time","setTime","styles","cx","name","UsersList","uid","chats","some","nick","users","length","ChatCard","chat","chatImg","setChatImg","getCompanionNick","ch","find","msgFrom","msgText","msgTmp","companionNick","getData","ChatsList","Lists","ChatRoute","sidebarShow","setSidebarShow","ProtectedRoute","CreateChat","search","useLocation","setChatId","companionNickname","URLSearchParams","createChatBetween","FormatTextEditor","label","onChange","isClear","onEnterHotKey","divRef","useRef","keyUpHandler","target","shiftKey","keyCode","textContent","innerHTML","current","role","contentEditable","editor","onKeyUp","ChatInput","messageText","setMessageText","messageHtml","setMessageHtml","clearField","setClearField","sendMessage","messageData","onSendHandler","onFormatTextChange","MessageBox","markup","isUser","setLastMsg","getMessageTime","el","system","messageBox","message","dangerouslySetInnerHTML","__html","ChatMessages","messages","messagesArr","setMessagesArr","setLastMessage","msg","scrollIntoView","behavior","ChatLayout","useParams","wrapp","BlankChat","App","useReducer","asyncDispatch","action","Provider","value","index","element","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","firebaseApp","initializeApp","apiKey","process","authDomain","projectId","storageBucket","messagingSenderId","databaseURL","appId","appCheck","initializeAppCheck","ReCaptchaV3Provider","isTokenAutoRefreshEnabled","getToken","catch","err","Router","HashRouter","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.fdf9f7f6.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"time\":\"MessageBox_time__1amKO\",\"system\":\"MessageBox_system__2871Y\",\"message\":\"MessageBox_message__6lLNX\",\"messageBox\":\"MessageBox_messageBox__1uNVV\",\"right\":\"MessageBox_right__2tdT1\",\"left\":\"MessageBox_left__2dMyd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"link\":\"ListCard_link__2li7z\",\"row\":\"ListCard_row__R_5PR\",\"time\":\"ListCard_time__uVD_M\",\"name\":\"ListCard_name__3VpCW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"editor\":\"FormatTextEditor_editor__2v75u\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapp\":\"ChatLayout_wrapp__3MyNo\"};","export default class Message {\n  /** @type {string} */from;\n  /** @type {string} */text;\n  /** @type {string} */textMarkup;\n  /** @type {number} */timestamp;\n\n  /**\n   * @param {string | Message} from user nickname or Message data\n   * @param {string} text \n   * @param {string} textMarkup \n   * @param {number} timestamp\n  */\n  constructor(from, text, textMarkup = null, timestamp = null) {\n    if (typeof from === 'object') {\n      from.text = from.textMarkup ? from.text.trim() : from.textMarkup = from.text.trim() ;\n\n      this.from = from.from;\n      this.text = from.text;\n      this.textMarkup = from.textMarkup.trim();\n      this.timestamp = from.timestamp ?? Date.now();\n    } else {\n      text = textMarkup ? text.trim() : textMarkup = text.trim();\n\n      this.from = from;\n      this.text = text;\n      this.textMarkup = textMarkup.trim();\n      this.timestamp = timestamp ?? Date.now();\n    }\n  }\n}","import { getDatabase, get, ref, child, set, onValue, off, query, runTransaction, push, limitToLast, orderByKey } from 'firebase/database';\nimport Message from 'models/Message';\n\nclass Database {\n  constructor(fireApp) {\n    this._app = fireApp;\n  }\n  _getDb() {\n    return getDatabase(this._app);\n  }\n  _getDbRef(...path) {\n    return ref(this._getDb(), ...path);\n  }\n\n  async getData(path) {\n    try {\n      const dbRef = this._getDbRef();\n      const snapshot = await get(child(dbRef, path));\n      return snapshot.val();\n    } catch (e) {\n      console.log(e);\n      return null;\n    }\n  }\n\n  writeData(path, data) {\n    try {\n      const db = this._getDb();\n      set(ref(db, path), data);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  listenData(path, callback, {limit = null} = {}) {\n    const dbRef = this._getDbRef(path);\n    const dbQuery = limit ? query(dbRef, orderByKey(), limitToLast(limit)) : query(dbRef); \n    onValue(dbQuery, (snap) => callback(snap.val()));\n    return () => off(dbRef);\n  }\n\n  async updateData(path, callback) {\n    const dbRef = this._getDbRef(path);\n\n    await runTransaction(dbRef, callback);\n  }\n\n  /**\n   * @param {string} userNickname \n   * @param {string} companioNickname \n   */\n  createChatBetween(userNickname, companioNickname) {\n    const timestamp = Date.now();\n    const chatId = timestamp.toString(36);\n    const newMessage = new Message('system', 'chat created') ;\n    this.writeData(`chatsMeta/${chatId}`, {\n      chatBetween: [userNickname, companioNickname],\n      createdAt: timestamp,\n      lastMessage: newMessage\n    });\n    this.pushMessageToChat(chatId, newMessage);\n    \n    this.updateData(`users/${userNickname}/chats`, this._addFieldToArr(chatId));\n    this.updateData(`users/${companioNickname}/chats`, this._addFieldToArr(chatId));\n\n    return chatId;\n  }\n\n  pushMessageToChat(chatId, newMessageData) {\n    try {\n      const chatRef = this._getDbRef(`chatsMessages/${chatId}`);\n      const newMsgRef = push(chatRef);\n      set(newMsgRef, newMessageData)\n        .then(() => {\n          this.writeData(`chatsMeta/${chatId}/lastMessage`, newMessageData);\n        });\n      \n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  _addFieldToArr(field) {\n    return (data) => {\n      if (Array.isArray(data) && !data.includes(field)) {\n        return [...data, field];\n      } else if (!Array.isArray(data)) {\n        return [field];\n      }\n    };\n  }\n}\n\nconst DB = new Database();\n\nexport default DB;","import DB from \"../../helpers/Database\";\n\nconst authUser = (userObj) => {\n  \n  DB.updateData(`users/${userObj.nickname}`, (dataObj) => ({...dataObj, ...userObj}));\n  localStorage.setItem('user', JSON.stringify(userObj));\n\n  return {\n    type: 'auth',\n    payload: userObj.nickname,\n  }\n}\n\nconst setUser = (/** @type {any} */ userObj) => ({\n  type: 'user/set',\n  payload: userObj,\n});\n\nconst logOut = () => {\n  localStorage.removeItem('user');\n\n  return {\n    type: 'user/remove',\n  }\n}\n\nexport { authUser, setUser, logOut };","import { createContext } from \"react\";\n\nconst defaultAuth = {\n  /** \n   * 0 - none,\n   * 1 - pending,\n   * 2 - authorized */\n  authState: localStorage.getItem('user') ? 2 : 0,\n  user: localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null,\n  nickname: localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')).nickname : null\n}\n\nconst AuthContext = createContext(defaultAuth);\n\nexport default AuthContext;\nexport { defaultAuth };\n","const authReducer = (state, {type, payload}) => {\n  switch(type) {\n    case 'auth':\n      return {\n        ...state,\n        nickname: payload,\n        authState: 1,\n      };\n    case 'user/set':\n      return {\n        ...state,\n        user: payload,\n        authState: 2,\n      }\n    case 'user/remove':\n      return {\n        ...state,\n        user: null,\n        nickname: null,\n        authState: 0,\n      }\n    default:\n      return state;\n  }\n}\n\nexport default authReducer;","export default function returnArrayFromObj(obj, withKeys) {\n  return withKeys ? Object.keys(obj).map(key => ({...obj[key], key})) : Object.values(obj);\n}","import { useState, useEffect} from \"react\";\nimport DB from \"../helpers/Database\";\nimport returnArrayFromObj from \"../helpers/returnArrayFromObj\";\n\nconst useListenFirebaseData = (queryPath, {filterCallback = null, startListen = null, limit = null, saveKey = false} = {}) => {\n  const [data, setData] = useState(null);\n\n  useEffect(() => {\n    if (startListen !== null && !startListen) return;\n    const unsubscribe = DB.listenData(queryPath, (dataObj) => {\n      if (dataObj === null) return;\n      let data = dataObj;\n      if (filterCallback) data = returnArrayFromObj(data, saveKey).filter(filterCallback);\n      setData(data);\n    }, {limit});\n\n    return () => unsubscribe();\n  }, [queryPath, filterCallback, startListen, limit, saveKey]);\n\n  return [data];\n}\n\nexport default useListenFirebaseData;","const getUserObject = ({providerData, metadata, email}) => ({\n  ...providerData[0],\n  nickname: email.split('@')[0].replace(/\\./g, ''),\n  lastLoginAt: metadata.lastLoginAt,\n});\n\nexport { getUserObject };\n","import React, { useCallback, useContext, useEffect } from 'react'\nimport { Navigate } from 'react-router';\nimport { getAuth, signInWithPopup, GoogleAuthProvider } from '@firebase/auth'\nimport AuthContext from '../../context/auth/authContext';\nimport { authUser } from '../../context/auth/authActions';\nimport { getUserObject } from '../../helpers/authData';\n\n\nexport default function AuthRoute() {\n  const [auth, dispatch] = useContext(AuthContext);\n\n  const authorize = useCallback(async () => {\n    const auth = getAuth();\n    const provider = new GoogleAuthProvider();\n    try {\n      const authResult = await signInWithPopup(auth, provider);\n      // const credential = GoogleAuthProvider.credentialFromResult(authenticateResult);\n      dispatch(authUser(getUserObject(authResult.user)))\n    } catch (e) {\n      console.log(e);\n    }\n  }, [dispatch]);\n\n  useEffect(() => {\n    document.title = 'Auth';\n  }, []);\n\n  if (auth.authState === 2) return <Navigate to={'/chat'} />\n\n  return (\n    <div\n      className=\"d-flex align-items-center justify-content-center\"\n      style={{height: '100vh'}}>\n      <button\n        onClick={authorize}\n        className=\"btn btn-primary btn-lg\">\n        <i className=\"bi bi-google\"></i>{' '}\n        Sign In\n        </button>\n    </div>\n  )\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useContext, useMemo, useState } from 'react'\nimport { logOut } from '../../context/auth/authActions';\nimport AuthContext from '../../context/auth/authContext';\n// import { logOut } from '../../contexts/auth/authAction';\n// import AuthContext from '../../contexts/auth/authContext';\n// import ChatContext from '../../contexts/chat/chatContext';\n\nexport default function Header({isAside, setAside}) {\n  const [{user}, dispatch] = useContext(AuthContext);\n  // const [{ companion  }] = useContext(ChatContext);\n  const [companion] = useState(false);\n  const [photoURL, displayName] = useMemo(() => [user.photoURL, user.displayName], [user]);\n\n  return (\n    <nav className=\"navbar navbar-light bg-light\">\n      <div className=\"container\">\n          <div className={`col-${isAside ? 3 : 1} text-start`}>\n            <button className=\"navbar-toggler\" type=\"button\" onClick={() => setAside(!isAside)}>\n              <span className=\"navbar-toggler-icon\"></span>\n            </button>\n          </div>\n          <div className={`col d-flex justify-content-${companion ? 'between' : 'end'}`}>\n            {companion && (\n              <span className=\"ms-2\">\n                <img src={companion.profile_picture} alt=\"\" width=\"30\" height=\"30\" className=\"d-inline-block align-text-top rounded\" />\n                <span className=\"mx-3 align-middle\"><b>{companion.username}</b></span>\n              </span>\n            )}\n            <span className=\"ms-5\">\n              <span className=\"mx-3 align-middle\"><b>{displayName}</b></span>\n              <img src={photoURL} alt=\"\" width=\"30\" height=\"30\" className=\"d-inline-block align-text-top rounded\" />\n            <div className=\"btn-group ms-3\">\n              <button className=\"btn btn-sm dropdown-toggle\" type=\"button\" data-bs-toggle=\"dropdown\" id=\"settingsList\" aria-expanded=\"false\">\n                <i className=\"bi bi-gear\"></i>\n              </button>\n              <ul className=\"dropdown-menu dropdown-menu-end\">\n                <li><a className=\"dropdown-item\" href=\"#\" onClick={() => dispatch(logOut())}>Logout</a></li>\n              </ul>\n            </div>\n            </span>\n          </div>\n      </div>\n    </nav>\n  )\n}\n","import moment from \"moment\";\n\nconst getLastDateTime = (timestamp) => {\n  const date = moment(timestamp);\n  const today = moment();\n\n  if (today.isAfter(date, 'date')) {\n    return today.to(date);\n  }\n  return date.format('HH:mm');\n}\n\nconst getMessageTime = (timestamp) => {\n  const time = moment(timestamp);\n  const now = moment();\n\n  if (time.isAfter(now, 'date')) {\n    return time.format('DD.MM HH:mm');\n  }\n  return time.format('HH:mm');\n}\n\nconst getFullMessageTime = (timestamp) => {\n  return moment(timestamp).format('DD.MM.YY HH:mm');\n}\n\nexport { getLastDateTime, getMessageTime, getFullMessageTime };","import React, { useEffect, useState } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { getLastDateTime } from '../../../helpers/dateTime';\nimport styles from './ListCard.module.css';\nimport cx from 'classnames';\n\nexport default function ListCard({photo, text, time, link, title}) {\n  const [Time, setTime] = useState(getLastDateTime(time));\n  useEffect(() => {\n    setTime(getLastDateTime(time));\n  }, [time]);\n  return (\n    <NavLink to={link} className={styles.link} title={title}>\n      <div className=\"card ms-2 pe-3 mb-2\">\n        <div className=\"row align-center flex-nowrap\">\n          <div className=\"col-3 p-0\">\n            <img src={photo} className=\"w-100 rounded-start\" alt=\"\" />\n          </div>\n          <div className=\"col d-flex justify-content-between align-self-center align-items-baseline overflow-hidden\">\n            <span className={cx(styles.name, 'col', 'text-start', title === 'system' && styles.time)}>{text}</span>\n            <span className={cx(styles.time, 'col', 'text-end')}>{Time}</span>\n          </div>\n        </div>\n      </div>\n    </NavLink>\n  )\n}\n","import React, { useCallback, useContext } from 'react';\nimport useListenFirebaseData from '../../../hooks/useListenFirebaseData';\nimport AuthContext from '../../../context/auth/authContext';\nimport ListCard from '../ListCard/ListCard';\n\nexport default function UsersList() {\n  const [{user}] = useContext(AuthContext);\n  const [users] = useListenFirebaseData('users', {\n    filterCallback: useCallback(({uid, chats}) => {\n      return (\n        (uid !== user.uid && !chats ) ||\n        (chats && user.chats && !chats?.some(nick => user.chats.includes(nick)))\n      )\n    }, [user])\n  });\n\n  return (\n    <div className=\"bg-white py-3\">\n      <span className=\"text-muted\">Users: {users?.length ?? 0}</span>\n      {users && users.length > 0 && users.map(({uid, nickname, displayName, photoURL, lastLoginAt}) => (\n        <ListCard \n          key={uid}\n          text={displayName}\n          time={+lastLoginAt}\n          photo={photoURL}\n          link={`new?user=${nickname}`}\n          />\n      ))}\n    </div>\n  );\n}\n","import React, { useEffect, useMemo, useState } from 'react';\nimport ListCard from 'components/Lists/ListCard/ListCard';\nimport useListenFirebaseData from 'hooks/useListenFirebaseData';\nimport DB from 'helpers/Database';\n\nexport default function ChatCard({chatId, nickname}) {\n  const [chat] = useListenFirebaseData(`chatsMeta/${chatId}`);\n  const [chatImg, setChatImg] = useState(null);\n  const [msgFrom, msgText, msgTmp, companionNick] = useMemo(() => {\n    const getCompanionNick = ch => ch?.chatBetween.find(nick => nick !== nickname) ?? nickname;\n    return [\n      chat?.lastMessage.from || getCompanionNick(chat),\n      chat?.lastMessage.text,\n      chat?.lastMessage.timestamp ?? chat?.createdAt,\n      getCompanionNick(chat)\n    ]\n  }, [chat, nickname]);\n\n  useEffect(() => {\n    (async () => {\n      const photo = await DB.getData(`users/${companionNick}/photoURL`);\n      setChatImg(photo);\n    })();\n  }, [companionNick]);\n  return (\n    <>\n      { chat && (\n        <ListCard\n          text={msgText || msgFrom}\n          time={msgTmp}\n          link={chatId}\n          title={msgFrom}\n          photo={chatImg ?? ''}\n          />\n      )}\n    </>\n  )\n}\n","import React, { useContext } from \"react\";\nimport AuthContext from \"context/auth/authContext\";\nimport ChatCard from \"./ChatCard/ChatCard\";\n\nexport default function ChatsList() {\n  const [{ user }] = useContext(AuthContext);\n  \n  return (\n    <div className=\"bg-white h-100 py-3\">\n      <span className=\"text-muted\">Chats: {user.chats?.length ?? 0}</span>\n      {user.chats && user.chats.map((chatId) => (\n        <ChatCard key={chatId} chatId={chatId} nickname={user.nickname} />\n      ))}\n    </div>\n  )\n}\n","import React from 'react';\nimport UsersList from \"./UsersList/UsersList\";\nimport ChatsList from './ChatsList/ChatsList';\n\nexport default function Lists() {\n  \n  return (\n    <div className=\"py-3 text-start\">\n      <UsersList />\n      <hr className=\"m-0\" />\n      <ChatsList />\n    </div>\n  )\n}\n","import React, {useEffect, useState} from 'react'\nimport { Outlet } from \"react-router-dom\";\nimport Header from '../../components/Header/Header';\nimport Lists from '../../components/Lists/Lists';\n\nexport default function ChatRoute() {\n  const [sidebarShow, setSidebarShow] = useState(true);\n  useEffect(() => {\n    document.title = 'Chat';\n  }, []);\n\n  return (\n    <div>\n      <Header isAside={sidebarShow} setAside={setSidebarShow} />\n      <div className=\"container\" style={{height: 'calc(100vh - 56px)'}}>\n        <div className=\"row h-100\">\n          {sidebarShow && <div className=\"col-3 h-100\"><Lists /></div>}\n          <div className=\"col h-100\">\n            <Outlet />\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, {useContext} from 'react'\nimport { Navigate, Outlet } from 'react-router';\nimport AuthContext from '../../context/auth/authContext';\n\nexport default function ProtectedRoute() {\n  const [auth] = useContext(AuthContext);\n  if (auth.authState === 0) {\n    return <Navigate to=\"/auth\" />\n  }\n  return <Outlet />\n}\n","import AuthContext from 'context/auth/authContext';\nimport DB from 'helpers/Database';\nimport React, { useEffect, useMemo, useState } from 'react'\nimport {Navigate, useLocation} from 'react-router';\nimport { useContext } from 'react/cjs/react.development';\n\nexport default function CreateChat() {\n  const { search } = useLocation();\n  const [chatId, setChatId] = useState(null);\n  const companionNickname = useMemo(() => new URLSearchParams(search).get('user'), [search]);\n  const [{user}] = useContext(AuthContext);\n  useEffect(() => {\n    if (!companionNickname) return;\n    setChatId(\n      DB.createChatBetween(user.nickname, companionNickname)\n    );\n  }, [user, companionNickname]);\n\n  return chatId && <Navigate to={'/chat/'+chatId} replace={true} />;\n}\n","import React, { useCallback, useEffect, useRef } from 'react';\nimport styles from './FormatTextEditor.module.css';\nimport cx from 'classnames';\n\nexport default function FormatTextEditor({label, onChange, isClear, onEnterHotKey}) {\n  const divRef = useRef(null);\n  const keyUpHandler = useCallback(({target, shiftKey, keyCode}) => {\n    const {textContent, innerHTML} = target;\n    onChange({textContent, innerHTML});\n    if (!shiftKey && keyCode === 13) onEnterHotKey();\n  }, [onChange, onEnterHotKey]);\n\n  useEffect(() => {\n    divRef.current.innerHTML = '';\n  }, [isClear]);\n\n  return (\n    <>\n      <div\n        ref={divRef}\n        role=\"textbox\"\n        contentEditable\n        className={cx('form-control perfect-scroll', styles.editor)}\n        onKeyUp={keyUpHandler}\n        />\n      <label>{label}</label>\n    </>\n  )\n}\n","import React, { useState, useCallback, useContext } from 'react';\nimport AuthContext from 'context/auth/authContext';\nimport DB from 'helpers/Database';\nimport Message from 'models/Message';\nimport FormatTextEditor from 'components/FormatTextEditor/FormatTextEditor';\n\nexport default function ChatInput({chatId}) {\n  const [{user}] = useContext(AuthContext);\n  const [messageText, setMessageText] = useState('');\n  const [messageHtml, setMessageHtml] = useState('');\n  const [clearField, setClearField] = useState(false);\n\n  const sendMessage = useCallback(() => {\n    if (!user || !messageText || !messageHtml) return;\n  \n    const messageData = new Message(user.nickname, messageText, messageHtml);\n    DB.pushMessageToChat(chatId, messageData);\n    setClearField(!clearField);\n  }, [chatId, user, messageHtml, messageText, clearField]);\n\n  const onSendHandler = useCallback(() => {\n    sendMessage(messageText);\n    setMessageText('');\n  }, [messageText, sendMessage]);\n\n  const onFormatTextChange = useCallback(({textContent, innerHTML}) => {\n    setMessageText(textContent);\n    setMessageHtml(innerHTML);\n  }, []);\n\n\n  return (\n    <div className=\"p-3\">\n      <div className=\"form-floating\">\n        <FormatTextEditor\n          label=\"Your message\"\n          onChange={onFormatTextChange}\n          isClear={clearField}\n          onEnterHotKey={onSendHandler}\n          />\n      </div>\n      <div className=\"form-group\">\n        <div className=\"row pt-3\">\n          <div className=\"col-7 text-start\">\n            <div className=\"btn-group\" role=\"group\" aria-label=\"Basic outlined example\">\n              \n            </div>\n          </div>\n          <div className=\"col-5 d-grid\">\n            <button className=\"btn btn-primary\" onClick={onSendHandler}>Send</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n","import React, { useEffect, useState } from 'react';\nimport styles from './MessageBox.module.css';\nimport cx from 'classnames';\nimport { getFullMessageTime, getMessageTime } from 'helpers/dateTime';\n\nexport default function MessageBox({ markup, from, isUser, time, setLastMsg }) {\n  const [Time, setTime] = useState(getFullMessageTime(time));\n\n  useEffect(() => {\n    setTime(from === 'system' ? getFullMessageTime(time) : getMessageTime(time));\n\n  }, [from, time]);\n\n  return (\n    <div className={`d-flex m-3 justify-content-${isUser ? 'end' : 'start'}`} ref={(el) => setLastMsg(el)}>\n      {from === 'system' && (<div title={Time} className={styles.system}>{markup}</div>)}\n      {from !== 'system' && (\n        <div className={cx(styles.messageBox, styles[isUser ? 'right' : 'left'], 'card px-3 p-2')}>\n          <div className=\"row\">\n            <div className={cx('col', (isUser ? 'text-end' : 'text-start'))}>\n              <p className={styles.message} dangerouslySetInnerHTML={{__html: markup}}></p>\n              <span className={cx('text-secondary', styles.time)} >{(Time)}</span>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n","import React, { useContext, useState, useEffect } from 'react';\nimport AuthContext from 'context/auth/authContext';\nimport returnArrayFromObj from 'helpers/returnArrayFromObj';\nimport Message from 'models/Message';\nimport MessageBox from './MessageBox/MessageBox';\n\nexport default function ChatMessages({messages}) {\n  const [{user}] = useContext(AuthContext);\n  const [messagesArr, setMessagesArr] = useState([]);\n  const [lastMessage, setLastMessage] = useState(null);\n\n  useEffect(() => {\n    if (!messages) return;\n    setMessagesArr(returnArrayFromObj(messages).map((msg) => new Message(msg)));\n  }, [messages]);\n  \n  useEffect(() => {\n    lastMessage && lastMessage.scrollIntoView({behavior: 'smooth'});\n  }, [lastMessage]);\n\n  return (\n    <div className=\"flex-grow-1 overflow-auto bg-light perfect-scroll\">\n      {messagesArr && messagesArr.map((/** @type {Message} */msg) => \n        <MessageBox\n          key={msg.timestamp}\n          markup={msg.textMarkup}\n          from={msg.from}\n          isUser={msg.from === user.nickname}\n          time={msg.timestamp}\n          setLastMsg={setLastMessage}\n          />\n      )}\n      {/* <Message isUser/> */}\n    </div>\n  )\n}\n","import React from 'react';\nimport useListenFirebaseData from 'hooks/useListenFirebaseData';\nimport { useParams } from 'react-router';\nimport ChatInput from './ChatInput/ChatInput';\nimport styles from './ChatLayout.module.css';\nimport ChatMessages from './ChatMessages/ChatMessages';\n\nexport default function ChatLayout() {\n  const { chatId } = useParams();\n  const [chat] = useListenFirebaseData(`chatsMessages/${chatId}`, {\n    limit: 50\n  });\n\n  \n  \n  return (\n    <div className={styles.wrapp}>\n      <ChatMessages messages={chat} />\n      <ChatInput chatId={chatId} />\n    </div>\n  )\n}\n","import React from 'react'\n\nexport default function BlankChat() {\n  return (\n    <div className=\"d-flex justify-content-center align-items-center h-100 text-muted bg-light\">\n      <h1>Choose a chat</h1>\n    </div>\n  )\n}\n","import React, { useCallback, useEffect, useReducer } from \"react\";\nimport { Routes, Route, Navigate } from \"react-router-dom\";\nimport './App.css';\nimport { setUser } from \"context/auth/authActions\";\nimport AuthContext, { defaultAuth } from \"context/auth/authContext\";\nimport authReducer from \"context/auth/authReducer\";\nimport useListenFirebaseData from \"hooks/useListenFirebaseData\";\nimport AuthRoute from \"routes/Auth/AuthRoute\";\nimport ChatRoute from \"routes/Chat/ChatRoute\";\nimport ProtectedRoute from \"routes/ProtectedRoute/ProtectedRoute\";\nimport CreateChat from \"components/CreateChat/CreateChat\";\nimport ChatLayout from \"components/ChatLayout/ChatLayout\";\nimport BlankChat from \"components/BlankChat/BlankChat\";\n\nfunction App() {\n  const [auth, dispatch] = useReducer(authReducer, defaultAuth);\n\n  const [user] = useListenFirebaseData(`/users/${auth.nickname}`, {startListen: auth.authState !== 0});\n  const asyncDispatch = useCallback(async (action) => {\n    const data = await action;\n    dispatch(data);\n  }, []);\n\n  useEffect(() => {\n    if (user) dispatch(setUser(user));\n  }, [user]);\n\n  return (\n    <div className=\"App\">\n      <AuthContext.Provider value={[auth, dispatch, asyncDispatch]}>\n        <Routes>\n          <Route index element={user ? <Navigate to=\"chat\" /> : <Navigate to=\"auth\" />} />\n          <Route path=\"auth\" element={<AuthRoute/>} />\n          <Route element={<ProtectedRoute />}> \n            <Route path=\"chat\" element={<ChatRoute />}>\n              <Route index element={<BlankChat />}></Route>\n              <Route path=\"new\" element={<CreateChat />}/>\n              <Route path=\":chatId\" element={<ChatLayout />}/>\n            </Route>\n          </Route>\n        </Routes>\n      </AuthContext.Provider>\n    </div>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { initializeApp } from 'firebase/app';\nimport \"firebase/auth\";\nimport { initializeAppCheck, ReCaptchaV3Provider, getToken  } from 'firebase/app-check';\n\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_DOMAIN,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_SENDER_ID,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID\n};\n\nconst firebaseApp = initializeApp(firebaseConfig);\nconst appCheck = initializeAppCheck(firebaseApp, {\n  provider: new ReCaptchaV3Provider(process.env.REACT_APP_FIREBASE_RECAPTCHA_API_KEY),\n  isTokenAutoRefreshEnabled: true\n});\n\ngetToken(appCheck).catch((err) => console.log(err));\n\nexport default firebaseApp;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, HashRouter } from \"react-router-dom\";\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport './firebaseApp';\nimport 'bootstrap-icons/font/bootstrap-icons.css';\nimport 'bootstrap';\n\nlet Router = HashRouter;\n\nif (process.env.NODE_ENV === 'development' && process.env.PUBLIC_URL === '') {\n  Router = BrowserRouter;\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <Router>\n      <App />\n    </Router>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}